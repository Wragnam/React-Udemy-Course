{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport { uiActions } from \"./ui\";\nconst initialCartState = {\n  items: [],\n  total: 0,\n  errorGettingCart: null\n};\nconst cartSlice = createSlice({\n  name: \"cart\",\n  initialState: initialCartState,\n  reducers: {\n    addToCart(state, action) {\n      const existingCartItem = state.items.find(item => item.id === action.payload.id);\n      if (existingCartItem) {\n        existingCartItem.quantity += 1;\n        existingCartItem.total += action.payload.price;\n      } else {\n        state.items.push({\n          ...action.payload,\n          quantity: 1,\n          total: action.payload.price\n        });\n      }\n      state.total += 1;\n    },\n    increase(state, action) {\n      const existingCartItem = state.items.find(item => item.id === action.payload);\n      existingCartItem.total += existingCartItem.price;\n      existingCartItem.quantity += 1;\n      state.total += 1;\n    },\n    decrease(state, action) {\n      const existingCartItem = state.items.find(item => item.id === action.payload);\n      if (existingCartItem.quantity === 1) {\n        state.items = state.items.filter(item => item.id !== action.payload);\n      } else {\n        existingCartItem.quantity -= 1;\n        existingCartItem.total -= existingCartItem.price;\n      }\n      state.total -= 1;\n    },\n    setCart(state, action) {\n      state.items = action.payload;\n    },\n    setError(state) {\n      state.error = true;\n    }\n  }\n});\nexport const setCartData = () => {\n  return async dispatch => {\n    const sendRequest = async () => {\n      const resp = await fetch(\"https://react-course-backend-18911-default-rtdb.europe-west1.firebasedatabase.app/cart.json\");\n      if (!resp.ok) {\n        throw new Error(\"Failed to fetch cart data!\");\n      }\n      const cartData = await resp.json();\n      return cartData;\n    };\n    let cartData;\n    try {\n      cartData = await sendRequest();\n    } catch (e) {\n      dispatch(cartActions.setError());\n      return;\n    }\n    dispatch(cartActions.setCart(cartData));\n  };\n};\nexport const sendCartData = cart => {\n  return async dispatch => {\n    dispatch(uiActions.showNotification({\n      status: \"pending\",\n      title: \"Sending\",\n      message: \"Sending cart data ... \"\n    }));\n    const sendRequest = async () => {\n      const resp = await fetch(\"https://react-course-backend-18911-default-rtdb.europe-west1.firebasedatabase.app/cart.json\", {\n        method: \"PUT\",\n        body: JSON.stringify(cart)\n      });\n      if (!resp.ok) {\n        throw new Error(\"Sending Cart Data failed!\");\n      }\n    };\n    try {\n      await sendRequest();\n      dispatch(uiActions.showNotification({\n        status: \"success\",\n        title: \"Success\",\n        message: \"Cart data sent successfully\"\n      }));\n    } catch (e) {\n      sendCartData().catch(error => {\n        dispatch(uiActions.showNotification({\n          status: \"error\",\n          title: \"Error\",\n          message: \"Sending cart data failed -> \" + error\n        }));\n      });\n    }\n  };\n};\nexport default cartSlice.reducer;\nexport const cartActions = cartSlice.actions;","map":{"version":3,"names":["createSlice","uiActions","initialCartState","items","total","errorGettingCart","cartSlice","name","initialState","reducers","addToCart","state","action","existingCartItem","find","item","id","payload","quantity","price","push","increase","decrease","filter","setCart","setError","error","setCartData","dispatch","sendRequest","resp","fetch","ok","Error","cartData","json","e","cartActions","sendCartData","cart","showNotification","status","title","message","method","body","JSON","stringify","catch","reducer","actions"],"sources":["C:/Users/PatrickClaassens/OneDrive/React Course/React-Udemy-Course/Section-21-Advanced-Redux/src/store/cart.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport { uiActions } from \"./ui\";\r\n\r\nconst initialCartState = { items: [], total: 0, errorGettingCart: null };\r\nconst cartSlice = createSlice({\r\n  name: \"cart\",\r\n  initialState: initialCartState,\r\n  reducers: {\r\n    addToCart(state, action) {\r\n      const existingCartItem = state.items.find(\r\n        (item) => item.id === action.payload.id\r\n      );\r\n      if (existingCartItem) {\r\n        existingCartItem.quantity += 1;\r\n        existingCartItem.total += action.payload.price;\r\n      } else {\r\n        state.items.push({\r\n          ...action.payload,\r\n          quantity: 1,\r\n          total: action.payload.price,\r\n        });\r\n      }\r\n      state.total += 1;\r\n    },\r\n    increase(state, action) {\r\n      const existingCartItem = state.items.find(\r\n        (item) => item.id === action.payload\r\n      );\r\n\r\n      existingCartItem.total += existingCartItem.price;\r\n      existingCartItem.quantity += 1;\r\n      state.total += 1;\r\n    },\r\n    decrease(state, action) {\r\n      const existingCartItem = state.items.find(\r\n        (item) => item.id === action.payload\r\n      );\r\n\r\n      if (existingCartItem.quantity === 1) {\r\n        state.items = state.items.filter((item) => item.id !== action.payload);\r\n      } else {\r\n        existingCartItem.quantity -= 1;\r\n        existingCartItem.total -= existingCartItem.price;\r\n      }\r\n      state.total -= 1;\r\n    },\r\n    setCart(state, action) {\r\n      state.items = action.payload;\r\n    },\r\n    setError(state) {\r\n      state.error = true;\r\n    },\r\n  },\r\n});\r\n\r\nexport const setCartData = () => {\r\n  return async (dispatch) => {\r\n    const sendRequest = async () => {\r\n      const resp = await fetch(\r\n        \"https://react-course-backend-18911-default-rtdb.europe-west1.firebasedatabase.app/cart.json\"\r\n      );\r\n\r\n      if (!resp.ok) {\r\n        throw new Error(\"Failed to fetch cart data!\");\r\n      }\r\n\r\n      const cartData = await resp.json();\r\n      return cartData;\r\n    };\r\n\r\n    let cartData;\r\n    try {\r\n      cartData = await sendRequest();\r\n    } catch (e) {\r\n      dispatch(cartActions.setError());\r\n      return;\r\n    }\r\n\r\n    dispatch(cartActions.setCart(cartData));\r\n  };\r\n};\r\n\r\nexport const sendCartData = (cart) => {\r\n  return async (dispatch) => {\r\n    dispatch(\r\n      uiActions.showNotification({\r\n        status: \"pending\",\r\n        title: \"Sending\",\r\n        message: \"Sending cart data ... \",\r\n      })\r\n    );\r\n\r\n    const sendRequest = async () => {\r\n      const resp = await fetch(\r\n        \"https://react-course-backend-18911-default-rtdb.europe-west1.firebasedatabase.app/cart.json\",\r\n        {\r\n          method: \"PUT\",\r\n          body: JSON.stringify(cart),\r\n        }\r\n      );\r\n\r\n      if (!resp.ok) {\r\n        throw new Error(\"Sending Cart Data failed!\");\r\n      }\r\n    };\r\n\r\n    try {\r\n      await sendRequest();\r\n      dispatch(\r\n        uiActions.showNotification({\r\n          status: \"success\",\r\n          title: \"Success\",\r\n          message: \"Cart data sent successfully\",\r\n        })\r\n      );\r\n    } catch (e) {\r\n      sendCartData().catch((error) => {\r\n        dispatch(\r\n          uiActions.showNotification({\r\n            status: \"error\",\r\n            title: \"Error\",\r\n            message: \"Sending cart data failed -> \" + error,\r\n          })\r\n        );\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport default cartSlice.reducer;\r\nexport const cartActions = cartSlice.actions;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}